"use strict";var _createClass=function(){function n(t,i){for(var o=0;o<i.length;o++){var n=i[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,i,o){return i&&n(t.prototype,i),o&&n(t,o),t}}();function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}require(["../scripts/config.js"],function(){require(["jquery","cookie"],function(s,t){new(function(){function i(t){_classCallCheck(this,i),this.url=t.url,this.tbody=t.tbody,this.load(),this.addEvent()}return _createClass(i,[{key:"load",value:function(){var n=this;s.ajax({url:this.url,dataType:"jsonp",jsonp:"callback",data:{blockIds:"266"},success:function(t){n.list=t.block_266,n.arr=[],s.each(n.list,function(t,i){var o=i.floorAllocations;n.arr=n.arr.concat(o),n.arr.splice(32,5)}),n.getCookie()}})}},{key:"getCookie",value:function(){this.goods=JSON.parse(s.cookie("goods")),this.display()}},{key:"display",value:function(){var n=this,e="";s.each(this.arr,function(t,o){s.each(n.goods,function(t,i){o.skuid==i.id&&(e+=' <tr style="height:240px;width:auto;">\n                                        <td>\n                                            <a href="javascript:;" class="img"><img src="'+o.img+'"></a>\n                                            <br>\n                                            <a href="javascript:;" class="name">'+o.name+"</a>\n                                        </td>\n                                        <td>\n                                            颜色:白色 \n                                            <br>\n                                            尺寸:44.5[100] \n                                        </td>\n                                        <td>"+o.skuprice+"元</td>\n                                        <td>"+o.skuprice+'元</td>\n                                        <td class="clear">\n                                            <input type="number" value="'+i.num+'" min=1 style="width:70px;margin-left:33px;">\n                                        </td>\n                                        <td class="total">'+o.skuprice.substr(1,o.skuprice.length-1)*i.num+'元</td>\n                                        <td goodId="'+o.skuid+'"><b style="cursor:pointer">删除</b></td>\n                                    </tr>'),n.tbody.html(e)})}),this.total()}},{key:"addEvent",value:function(){var t=this;this.tbody.on("click","b",function(){t.id=s(this).parent().attr("goodId"),s(this).parent().parent().remove(),t.removeCookie()}),this.tbody.on("input","input",function(){t.id=s(this).parent().next().next().attr("goodId"),t.num=s(this).val(),t.changeCookie()}),s("div.option").find("input").click(function(){s(this).parent().prev().children("tbody").remove(),t.removeAllCookie(),t.total()})}},{key:"removeCookie",value:function(){for(var t=0;t<this.goods.length&&this.goods[t].id!=this.id;t++);this.goods.splice(t,1),s.cookie("goods",JSON.stringify(this.goods))}},{key:"removeAllCookie",value:function(){s.cookie("goods",null)}},{key:"changeCookie",value:function(){for(var t=0;t<this.goods.length;t++)this.goods[t].id==this.id&&(this.goods[t].num=this.num);s.cookie("goods",JSON.stringify(this.goods))}},{key:"total",value:function(){this.totalPrice=Array.from(s("td.total"));for(var t=this.num=0;t<this.totalPrice.length;t++)this.price=parseInt(this.totalPrice[t].innerText),this.num+=this.price;s("div.option").find("span").html(this.num)}}]),i}())({url:"https://dms-dataapi.meizu.com/data/jsdata.jsonp?",tbody:s("tbody")})})});